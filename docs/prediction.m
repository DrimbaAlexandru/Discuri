ys = [ -0.07358, -0.08426, -0.08234, -0.07010, -0.05133, -0.04868, -0.03976, -0.01343, 0.00607, 0.01761, 0.03265, 0.04761, 0.05948, 0.05832, 0.05069, 0.04019, 0.03391, 0.03574, 0.04443, 0.03821, 0.03381, 0.02808, 0.02734, 0.02197, 0.01974, 0.01471, 0.01154, 0.00595, 0.00256, -0.00546, -0.01398, -0.02100, -0.02847, -0.02930, -0.03369, -0.02917, -0.02866, -0.02643, -0.02640, -0.02536, -0.00928, 0.00388, 0.01880, 0.04187, 0.04398, 0.04422, 0.05450, 0.06329, 0.06558, 0.06476, 0.06683, 0.06509, 0.06470, 0.05612, 0.04767, 0.04117, 0.02728, 0.01733, 0.00122, -0.01395, -0.01337, -0.03107, -0.06155, -0.07614, -0.08792, -0.09296, -0.10779, -0.12277, -0.11798, -0.13126, -0.10818, -0.03085, 0.00458, 0.05988, -0.09558, -0.28320, -0.08273, 0.01389, -0.02734, -0.02954, -0.02310, -0.02286, -0.01477, -0.00095, -0.00372, -0.00311, -0.00845, -0.01544, -0.02695, -0.03848, -0.04681, -0.05917, -0.06219, -0.06540, -0.06049, -0.05966, -0.05869, -0.05338, -0.04907, -0.05023, -0.04794, -0.04678, -0.04242, -0.03821, -0.02991, -0.02454, -0.01169, -0.00946, -0.00626, 0.00024, 0.00723, 0.00616, 0.00858, 0.00769, 0.00937, 0.01178, 0.01660, 0.01944, 0.02548, 0.02969, 0.03613, 0.04117, 0.04916, 0.05365, 0.05524, 0.06195, 0.06271, 0.06750, 0.07437, 0.06833, 0.06882, 0.06927, 0.06873, 0.06714, 0.06213, 0.06387, 0.05777, 0.05460, 0.05106, 0.04681, 0.04218, 0.03549, 0.02600, 0.02005, 0.00842, -0.00043, -0.01486, -0.02533, -0.03635, -0.04611 ];
n = size( ys )( 2 );
xs = linspace( 0, n - 1, n );
%plot( xs, ys );

marking = [ 68, 79 ];

lys = ys( 1 : marking( 1 ) );
lxs = xs( 1 : marking( 1 ) );
mys = ys( marking( 1 ) : marking( 2 ) );
mxs = xs( marking( 1 ) : marking( 2 ) );
rys = ys( marking( 2 ) : end );
rxs = xs( marking( 2 ) : end );

ys_copy = ys( : , : );
ys_copy = burg_predict( ys_copy, marking( 1 ), marking( 2 ) );

ys_copy2 = fliplr( ys_copy );
ys_copy2 = burg_predict( ys_copy2, n - marking( 2 ), n - marking( 1 ) );
ys_copy2 = fliplr( ys_copy2 );
pfl = ys_copy( marking( 1 ) : marking( 2 ) );
pfr = ys_copy2( marking( 1 ) : marking( 2 ) );

plot( lxs, lys,'b', mxs, mys,'r', rxs, rys,'b' );
axis( [ xs( 1 ) xs( end ) -0.5 0.5 ]  );

waitforbuttonpress();

plot( lxs, lys, 'b', mxs, pfl, 'g', mxs, pfr, 'g', rxs, rys, 'b' );
axis( [ xs( 1 ) xs( end ) -0.5 0.5 ]  );

waitforbuttonpress();

fade = cos( linspace( 0, 1, size( pfl )( 2 ) ) .* pi ./ 2 );
pfl = pfl .* ( fade );
pfr = pfr .* ( 1 - fade );

plot( lxs, lys, 'b', mxs, pfl, 'g', mxs, pfr, 'g', rxs, rys, 'b' );
axis( [ xs( 1 ) xs( end ) -0.5 0.5 ]  );

waitforbuttonpress();

plot( lxs, lys, 'b', mxs, pfl+pfr, 'g', rxs, rys, 'b' );
axis( [ xs( 1 ) xs( end ) -0.5 0.5 ]  );